{"version":3,"sources":["Darkmode.tsx","storage.ts","tasks/TimedTask.ts","Editor.tsx","Greeting.tsx","Visualization.tsx","App.tsx","index.tsx"],"names":["Darkmode","_ref","theme","setTheme","setDocumentTheme","localStorage","setItem","document","documentElement","setAttribute","useEffect","updateClosure","event","storageArea","key","newValue","window","addEventListener","removeEventListener","react_default","a","createElement","className","id","type","tabIndex","onChange","checked","htmlFor","xmlns","version","x","y","viewBox","d","STRINGIFIED_SAVE","JSON","stringify","content","OVERDUE","DUE_TODAY","DUE_SOON","NOT_URGENT","MS_IN_DAYS","calculateUrgency","deadline","diff","getTime","Date","parseTime","text","parsedResults","chrono","length","time","start","date","getAttributes","match","input","TimedTask","Mark","create","name","addAttributes","default","parseHTML","element","getAttribute","renderHTML","attributes","data-time","locale-string","toLocaleString","month","day","hour","minute","uid","color","style","concat","onCreate","_this","this","transaction","editor","state","tr","doc","descendants","node","pos","timeMark","marks","find","mark","undefined","end","nodeSize","removeMark","newMark","attrs","nanoid","addMark","setMeta","view","dispatch","onUpdate","_this2","newTime","Object","objectSpread","tag","addInputRules","markInputRule","addPasteRules","markPasteRule","HTMLAttributes","Editor","setTasks","refreshTasks","newTasks","push","due","oldTasks","useEditor","extensions","StarterKit","configure","heading","levels","codeBlock","class","Focus","mode","Link","protocols","Placeholder","placeholder","Typography","Image","parse","getItem","_ref2","_ref3","blocks","getJSON","dump","commands","setContent","tiptap_react_esm","onDrop","evt","preventDefault","stopPropagation","fileList","dataTransfer","files","file","reader","FileReader","target","uploaded_image","result","chain","focus","setImage","src","run","readAsDataURL","Greeting","props","greeting","getHours","calculateGreeting","calcTime","toLocaleTimeString","_useState","useState","_useState2","slicedToArray","setTime","timer","setInterval","clearInterval","numTasks","numUrgentTasks","tasks","calculateTaskString","daysDiff","Math","max","isDueSoon","task","withSize","fgRef","useRef","nodes","map","val","pow","fg","current","d3Force","forceManyBody","strength","forceCollide","radius","sqrt","d3ReheatSimulation","paint","useCallback","ctx","isDark","fillStyle","beginPath","arc","PI","fill","src_Greeting","filter","react_force_graph_2d_module","ref","height","width","size","nodeLabel","onNodeClick","nodeEl","getElementById","toString","classList","add","scrollIntoView","setTimeout","remove","enablePanInteraction","enableZoomInteraction","nodeCanvasObject","graphData","links","App","_useState3","userPref","matchMedia","matches","currentTheme","loadDefault","_useState4","src_Darkmode","src_Visualization","src_Editor_0","ReactDOM","createRoot","render","StrictMode","src_App"],"mappings":"0SAsDeA,MAvCf,SAAAC,GAAkD,IAA9BC,EAA8BD,EAA9BC,MAAOC,EAAuBF,EAAvBE,SACnBC,EAAmB,SAACF,GACxBC,EAASD,GACTG,aAAaC,QAAQ,QAASJ,GAC9BK,SAASC,gBAAgBC,aAAa,cAAeP,IAkBvD,OAXAQ,oBAAU,WACR,IAAMC,EAAgB,SAACC,GACjBA,EAAMC,cAAgBR,cACR,UAAdO,EAAME,KAAsC,OAAnBF,EAAMG,UACjCX,EAAiBQ,EAAMG,WAI3B,OADAC,OAAOC,iBAAiB,UAAWN,GAC5B,kBAAMK,OAAOE,oBAAoB,UAAWP,KAClD,IAEKQ,EAAAC,EAAAC,cAAA,OAAKC,UAAU,YACrBH,EAAAC,EAAAC,cAAA,SAAOC,UAAU,SAASC,GAAG,kBAAkBC,KAAK,WAAWC,UAAW,EAAGC,SAhB3D,WAClBtB,EAA2B,SAAVF,EAAmB,QAAU,SAesDyB,QAAmB,SAAVzB,IAC7GiB,EAAAC,EAAAC,cAAA,SAAOE,GAAG,qBAAqBK,QAAQ,kBAAkBH,UAAW,GAClEN,EAAAC,EAAAC,cAAA,OAAKQ,MAAM,6BAA6BC,QAAQ,MAAMP,GAAG,UAAUQ,EAAE,MAAMC,EAAE,MAAMC,QAAQ,aACzFd,EAAAC,EAAAC,cAAA,2BACAF,EAAAC,EAAAC,cAAA,QAAMa,EAAE,s7CAGZf,EAAAC,EAAAC,cAAA,SAAOE,GAAG,oBAAoBK,QAAQ,kBAAkBH,UAAW,GACjEN,EAAAC,EAAAC,cAAA,OAAKQ,MAAM,6BAA6BC,QAAQ,MAAMP,GAAG,YAAYQ,EAAE,MAAMC,EAAE,MAAMC,QAAQ,eAC3Fd,EAAAC,EAAAC,cAAA,0BACAF,EAAAC,EAAAC,cAAA,QAAMa,EAAE,ogBCxCVC,EAAmBC,KAAKC,UALG,CAC/Bb,KAAM,MACNc,QAAS,uFCILC,EAAU,YACVC,EAAY,YACZC,EAAW,YACXC,EAAa,YACNC,EAAa,MAE1B,SAASC,EAAiBC,GACxB,IAAMC,EAAOD,EAASE,WAAY,IAAIC,MAAOD,UAC7C,OAAID,EAAO,EACFP,EACEO,GAAQH,EAEVH,EACEM,GAAqB,EAAbH,EACVF,EAEAC,EAIX,SAASO,EAAUC,GACjB,IAAMC,EAAgBC,QAAaF,GAAQ,IAC3C,OAAIC,EAAcE,OAAS,GAElB,CAAEC,KADUH,EAAc,GACPI,MAAMC,OAAOT,WAM3C,SAASU,EAAcC,GAErB,OAAOT,EADMS,EAAMC,OAId,IAAMC,EAAYC,IAAKC,OAAO,CACnCC,KAAM,YAENC,cAHmC,WAIjC,MAAO,CACLV,KAAM,CACJW,QAAS,KACTC,UAAW,SAAAC,GAAO,OAAIA,EAAQC,aAAa,eAAgB,IAAIpB,MAAOD,WACtEsB,WAAY,SAAAC,GAAU,MAAK,CACzBC,YAAaD,EAAWhB,KACxBkB,gBAAiB,IAAIxB,KAAKsB,EAAWhB,MAAMmB,eAAe,QAAS,CACjEC,MAAO,QACPC,IAAK,UACLC,KAAM,UACNC,OAAQ,eAIdC,IAAK,CACHb,QAAS,KACTI,WAAY,SAAAC,GAAU,MAAK,CACzB/C,GAAI+C,EAAWQ,OAGnBC,MAAO,CACLd,QAASvB,EACT2B,WAAY,SAAAC,GAAU,MAAK,CACzBU,MAAK,eAAAC,OAAiBX,EAAWS,YAMzCG,SAjCmC,WAiCxB,IAAAC,EAAAC,KACHC,EAAcD,KAAKE,OAAOC,MAAMC,GACtCJ,KAAKE,OAAOC,MAAME,IAAIC,YAAY,SAACC,EAAMC,GACvC,GAAuB,SAAnBD,EAAKnE,KAAKuC,KAAiB,CAC7B,IAAM8B,EAAWF,EAAKG,MAAMC,KAAK,SAACC,GAAD,OAAUA,EAAKxE,KAAKuC,OAASoB,EAAKpB,OACnE,QAAiBkC,IAAbJ,EAAwB,CAC1B,IAAMtC,EAAQqC,EACRM,EAAMN,EAAMD,EAAKQ,SACvBd,EAAYe,WAAW7C,EAAO2C,EAAKL,GACnC,IAAMQ,EAAUlB,EAAK3D,KAAKsC,OAAO,CAC/BiB,MAAOnC,EAAiB,IAAII,KAAK6C,EAASS,MAAMhD,OAChDA,KAAMuC,EAASS,MAAMhD,KACrBwB,IAAKyB,gBAEPlB,EAAYmB,QAAQjD,EAAO2C,EAAKG,OAKtChB,EAAYoB,QAAQ,gBAAgB,GACpCpB,EAAYoB,QAAQ,iBAAiB,GACrCrB,KAAKE,OAAOoB,KAAKC,SAAStB,IAG5BuB,SAzDmC,WAyDxB,IAAAC,EAAAzB,KACHC,EAAcD,KAAKE,OAAOC,MAAMC,GACtCJ,KAAKE,OAAOC,MAAME,IAAIC,YAAY,SAACC,EAAMC,GACvC,GAAuB,SAAnBD,EAAKnE,KAAKuC,KAAiB,CAC7B,IAAM8B,EAAWF,EAAKG,MAAMC,KAAK,SAACC,GAAD,OAAUA,EAAKxE,KAAKuC,OAAS8C,EAAK9C,OACnE,QAAiBkC,IAAbJ,EAAwB,CAC1B,IAAMtC,EAAQqC,EACRM,EAAMN,EAAMD,EAAKQ,SACjBW,EAAU7D,EAAU0C,EAAKzC,MAC/B,GAAI4D,EAAS,CACX,IAAMT,EAAUQ,EAAKrF,KAAKsC,OAAViD,OAAAC,EAAA,EAAAD,CAAA,GACXD,EADW,CAEdhC,IAAKe,EAASS,MAAMxB,IACpBC,MAAOnC,EAAiB,IAAII,KAAK8D,EAAQxD,UAE3C+B,EAAYe,WAAW7C,EAAO2C,EAAKL,GACnCR,EAAYmB,QAAQjD,EAAO2C,EAAKG,QAMxChB,EAAYoB,QAAQ,gBAAgB,GACpCpB,EAAYoB,QAAQ,iBAAiB,GACrCrB,KAAKE,OAAOoB,KAAKC,SAAStB,IAG5BnB,UApFmC,WAqFjC,MAAO,CACL,CACE+C,IAAK,qBAKXC,cA5FmC,WA6FjC,MAAO,CACLC,YAAc,CACZpB,KAAM,0BACNvE,KAAM4D,KAAK5D,KACXiC,oBAKN2D,cAtGmC,WAuGjC,MAAO,CACLC,YAAc,CACZtB,KAAM,2BACNvE,KAAM4D,KAAK5D,KACXiC,oBAKNY,WAhHmC,SAAApE,GAiHjC,MAAO,CACL,OAF2BA,EAAlBqH,eAIT,MC7BSC,EAnGA,SAAAtH,GAA2B,IAAxBuH,EAAwBvH,EAAxBuH,SACVC,EAAe,SAACnC,GACpB,IAAMoC,EAAoB,GAC1BpC,EAAOC,MAAME,IAAIC,YAAY,SAACC,GAC5B,GAAuB,SAAnBA,EAAKnE,KAAKuC,KAAiB,CAC7B,IAAM8B,EAAWF,EAAKG,MAAMC,KAAK,SAACC,GAAD,MAA6B,cAAnBA,EAAKxE,KAAKuC,YACpCkC,IAAbJ,GACF6B,EAASC,KAAK,CAAEC,IAAK/B,EAASS,MAAMhD,KAAMwB,IAAKe,EAASS,MAAMxB,SAKpE0C,EAAS,SAACK,GACR,OAAIzF,KAAKC,UAAUwF,KAAczF,KAAKC,UAAUqF,GACvCA,EAEAG,KAKPvC,EAASwC,YAAU,CACvBC,WAAY,CACVC,IAAWC,UAAU,CACnBC,QAAS,CACPC,OAAQ,CAAC,EAAG,EAAG,IAEjBC,UAAW,CACTd,eAAgB,CACde,MAAO,gBAIbC,IAAML,UAAU,CACdM,KAAM,YAERC,IAAKP,UAAU,CACbQ,UAAW,CAAC,YAEdC,IAAYT,UAAU,CACpBU,YA3Dc,8TA6DhBC,IACAC,IACAjF,GAEFtB,QFnEKF,KAAK0G,MAAMzI,aAAa0I,QAAQ,WAAa5G,GEoElD+C,SAAU,SAAA8D,GAAA,IAAG1D,EAAH0D,EAAG1D,OAAH,OAAgBmC,EAAanC,IACvCsB,SAAU,SAAAqC,GAAgB,IFlETC,EEkEJ5D,EAAa2D,EAAb3D,OACXmC,EAAanC,GFnEE4D,EEoEV5D,EAAO6D,UFnEhB9I,aAAaC,QAAQ,SAAU8B,KAAKC,UAAU6G,OEwE9ClI,OAAM,SAAe,CACnBoI,KAAM,kBAAM9D,EAASA,EAAO6D,UAAY,OAG1CzI,oBAAU,WACR,IAAMC,EAAgB,SAACC,GACjBA,EAAMC,cAAgBR,cACR,WAAdO,EAAME,KAAuC,OAAnBF,EAAMG,UAC9BuE,IACFA,EAAO+D,SAASC,WAAWlH,KAAK0G,MAAMlI,EAAMG,WAC5C0G,EAAanC,KAKnB,OADAtE,OAAOC,iBAAiB,UAAWN,GAC5B,kBAAMK,OAAOE,oBAAoB,UAAWP,KAClD,CAAC2E,IAmBJ,OAAKA,EAKHnE,EAAAC,EAAAC,cAACkI,EAAA,EAAD,CAAeC,OAtBE,SAACC,GAClBA,EAAIC,iBACJD,EAAIE,kBACJ,IAAMC,EAAWH,EAAII,aAAaC,MAClC,GAAIF,EAASvG,QAAU,EAAG,CACxB,IAAM0G,EAAOH,EAAS,GAChBI,EAAS,IAAIC,WACnBD,EAAO/I,iBAAiB,OAAQ,SAACwI,GAC/B,GAAIA,EAAIS,QAAU5E,EAAQ,CACxB,IAAM6E,EAAiB,GAAKV,EAAIS,OAAOE,OACvC9E,EAAO+E,QAAQC,QAAQC,SAAS,CAAEC,IAAKL,IAAkBM,SAG7DT,EAAOU,cAAcX,KASYzE,OAAQA,IAJpC,+CChFIqF,MAhBf,SAAkBC,GAChB,IAAMC,EApBR,WACE,IAAMjG,GAAO,IAAI5B,MAAO8H,WACxB,OAAIlG,EAAO,GACF,eACEA,EAAO,GACT,iBAEA,eAaQmG,GACXC,EAAW,kBAAM,IAAIhI,MAAOiI,wBAAmBhF,EAAW,CAAErB,KAAM,UAAWC,OAAQ,aAFzDqG,EAGVC,mBAASH,KAHCI,EAAArE,OAAAsE,EAAA,EAAAtE,CAAAmE,EAAA,GAG3B5H,EAH2B8H,EAAA,GAGrBE,EAHqBF,EAAA,GAUlC,OALA1K,oBAAU,WACR,IAAM6K,EAAQC,YAAY,kBAAMF,EAAQN,MAAa,KACrD,OAAO,kBAAMS,cAAcF,KAC1B,IAEKpK,EAAAC,EAAAC,cAAA,OAAKC,UAAU,WACrBH,EAAAC,EAAAC,cAAA,UAAKiC,GACLnC,EAAAC,EAAAC,cAAA,SAAIwJ,EAAJ,KApBJ,SAA6Ba,EAAkBC,GAC7C,GAAiB,IAAbD,EACF,MAAO,wBAET,IAAME,EAAqB,IAAbF,EAAiB,OAAS,QACxC,kBAAAzG,OAAmByG,EAAnB,KAAAzG,OAA+B2G,EAA/B,UAAA3G,OAA6C0G,EAA7C,mCAekBE,CAAoBjB,EAAMc,SAAUd,EAAMe,0BCrB9D,SAASG,EAAStI,GAChB,OAAOuI,KAAKC,IAAI,EAAGxI,GAAQ,IAAIR,MAAOD,WAAcJ,EAOtD,SAASsJ,EAAUC,GACjB,OAAOJ,EAASI,EAAKtE,KAAO,EAqDfuE,2BAjDf,SAAuBvB,GACrB,IAAMwB,EAAQC,mBACRC,EAAQ1B,EAAMgB,MAAMW,IAAI,SAAAL,GAAI,MAAK,CACrC3K,GAAI2K,EAAKpH,IACT0H,KAbgBhJ,EAaA0I,EAAKtE,IAZhB,GAAKmE,KAAKU,IAAI,KAAMX,EAAStI,IAAS,IAD/C,IAAoBA,IAgBlB9C,oBAAU,WACR,IAAMgM,EAAKN,EAAMO,QACbD,IACFA,EAAGE,QAAQ,SAAUC,cAAgBC,SAAS,KAE9CJ,EAAGE,QAAQ,UAAWG,cAAeC,OAAO,SAAArH,GAAI,OAAI,EAAIoG,KAAKkB,KAAKtH,EAAK6G,QACvEE,EAAGQ,uBAEJ,CAACd,EAAMO,UAGV,IAAMQ,EAAQC,sBAAY,SAACzH,EAAM0H,GAC/B,IAAMC,EAAyB,SAAhB1C,EAAM1K,MACrBmN,EAAIE,UAAYD,EAAS,UAAY,UACrCD,EAAIG,YACJH,EAAII,IAAI9H,EAAK5D,EAAG4D,EAAK3D,EAAG,EAAI+J,KAAKkB,KAAKtH,EAAK6G,KAAM,EAAG,EAAIT,KAAK2B,IAAI,GACjEL,EAAIM,QACH,CAAC/C,EAAM1K,QAEV,OAAOiB,EAAAC,EAAAC,cAAA,OAAKC,UAAU,iBACpBH,EAAAC,EAAAC,cAACuM,EAAD,CAAUlC,SAAUd,EAAMgB,MAAMvI,OAAQsI,eAAgBf,EAAMgB,MAAMiC,OAAO5B,GAAW5I,SACtFlC,EAAAC,EAAAC,cAACyM,EAAA,EAAD,CACEC,IAAK3B,EACL4B,OAAQ,IACRC,MAAOrD,EAAMsD,KAAKD,MAClBE,UAAU,GACVC,YAAa,SAACzI,GACZ,IAAM0I,EAAS9N,SAAS+N,gBAAgB3I,EAAKpE,IAAM,IAAIgN,YACnDF,IACFA,EAAOG,UAAUC,IAAI,aACrBJ,EAAOK,iBACPC,WAAW,kBAAMN,EAAOG,UAAUI,OAAO,cAAc,OAG3DC,sBAAsB,EACtBC,uBAAuB,EACvBC,iBAAkB5B,EAClB6B,UAAW,CAAE1C,QAAO2C,MAAO,SCzDlBC,MAZf,WAAe,IAAAhE,EACaC,mBAAkB,IAD/BC,EAAArE,OAAAsE,EAAA,EAAAtE,CAAAmE,EAAA,GACNU,EADMR,EAAA,GACC5D,EADD4D,EAAA,GAAA+D,EAEahE,mBNLrB,WACL,IAAMiE,EAAWpO,OAAOqO,WAAW,iCAAiCC,QAAU,QAAU,OAClFC,EAAelP,aAAa0I,QAAQ,UAAYqG,EAEtD,OADA7O,SAASC,gBAAgBC,aAAa,cAAe8O,GAC9CA,EMC4BC,IAFtBC,EAAA1I,OAAAsE,EAAA,EAAAtE,CAAAoI,EAAA,GAENjP,EAFMuP,EAAA,GAECtP,EAFDsP,EAAA,GAGb,OACEtO,EAAAC,EAAAC,cAAA,OAAKC,UAAU,OACbH,EAAAC,EAAAC,cAACqO,EAAD,CAAUxP,MAAOA,EAAOC,SAAUA,IAClCgB,EAAAC,EAAAC,cAACsO,EAAD,CAAe/D,MAAOA,EAAO1L,MAAOA,IACpCiB,EAAAC,EAAAC,cAACuO,EAAD,CAAQpI,SAAUA,MCRXqI,IAASC,WACpBvP,SAAS+N,eAAe,SAGrByB,OACH5O,EAAAC,EAAAC,cAACF,EAAAC,EAAM4O,WAAP,KACE7O,EAAAC,EAAAC,cAAC4O,EAAD","file":"static/js/main.b1d69d27.chunk.js","sourcesContent":["import React, { useEffect } from 'react';\nimport './Darkmode.css'\n\nexport function loadDefault() {\n  const userPref = window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark'\n  const currentTheme = localStorage.getItem('theme') || userPref;\n  document.documentElement.setAttribute('saved-theme', currentTheme);\n  return currentTheme;\n}\n\ninterface IDarkmode {\n  theme: string,\n  setTheme: (newTheme: string) => void,\n}\n\nfunction Darkmode({ theme, setTheme }: IDarkmode) {\n  const setDocumentTheme = (theme: string) => {\n    setTheme(theme);\n    localStorage.setItem('theme', theme);\n    document.documentElement.setAttribute('saved-theme', theme);\n  }\n\n  const switchTheme = () => {\n    setDocumentTheme(theme === 'dark' ? 'light' : 'dark');\n  }\n\n  useEffect(() => {\n    const updateClosure = (event: StorageEvent) => {\n      if (event.storageArea !== localStorage) return;\n      if (event.key === 'theme' && event.newValue !== null) {\n        setDocumentTheme(event.newValue);\n      }\n    };\n    window.addEventListener('storage', updateClosure);\n    return () => window.removeEventListener('storage', updateClosure);\n  }, []);\n\n  return (<div className='darkmode'>\n    <input className='toggle' id='darkmode-toggle' type='checkbox' tabIndex={-1} onChange={switchTheme} checked={theme === 'dark'} />\n    <label id=\"toggle-label-light\" htmlFor='darkmode-toggle' tabIndex={-1}>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" id=\"dayIcon\" x=\"0px\" y=\"0px\" viewBox=\"0 0 35 35\" >\n        <title>Light Mode</title>\n        <path d=\"M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z\" />\n      </svg>\n    </label>\n    <label id=\"toggle-label-dark\" htmlFor='darkmode-toggle' tabIndex={-1}>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" id=\"nightIcon\" x=\"0px\" y=\"0px\" viewBox=\"0 0 100 100\">\n        <title>Dark Mode</title>\n        <path d=\"M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z\" />\n      </svg>\n    </label>\n  </div>)\n}\n\nexport default Darkmode;\n","import { JSONContent } from \"@tiptap/react\";\n\ntype OutputData = JSONContent;\nconst DEFAULT_SAVE: OutputData = {\n  type: \"doc\",\n  content: [],\n}\n\nconst STRINGIFIED_SAVE = JSON.stringify(DEFAULT_SAVE);\n\nexport function load(): OutputData {\n  return JSON.parse(localStorage.getItem('blocks') || STRINGIFIED_SAVE)\n};\n\nexport function save(blocks: OutputData) {\n  localStorage.setItem('blocks', JSON.stringify(blocks));\n};\n","import { Mark, markPasteRule, markInputRule, ExtendedRegExpMatchArray } from '@tiptap/core'\nimport * as chrono from 'chrono-node';\nimport { nanoid } from 'nanoid';\n\nexport interface TimedTaskOptions {\n  HTMLAttributes: Record<string, any>,\n}\n\nconst TRANSPARENCY = \"55\";\nconst OVERDUE = \"#ff3333\" + TRANSPARENCY;\nconst DUE_TODAY = \"#ffa333\" + TRANSPARENCY;\nconst DUE_SOON = \"#fff000\" + TRANSPARENCY;\nconst NOT_URGENT = \"#99999933\";\nexport const MS_IN_DAYS = 86400000;\n\nfunction calculateUrgency(deadline: Date) {\n  const diff = deadline.getTime() - new Date().getTime();\n  if (diff < 0) {\n    return OVERDUE;\n  } else if (diff <= MS_IN_DAYS) {\n\n    return DUE_TODAY;\n  } else if (diff <= MS_IN_DAYS * 3) {\n    return DUE_SOON;\n  } else {\n    return NOT_URGENT;\n  }\n}\n\nfunction parseTime(text: string | undefined) {\n  const parsedResults = chrono.parse(text || \"\");\n  if (parsedResults.length > 0) {\n    const parsedTime = parsedResults[0];\n    return { time: parsedTime.start.date().getTime() }\n  } else {\n    return false\n  }\n}\n\nfunction getAttributes(match: ExtendedRegExpMatchArray) {\n  const text = match.input;\n  return parseTime(text);\n}\n\nexport const TimedTask = Mark.create({\n  name: 'timedTask',\n\n  addAttributes() {\n    return {\n      time: {\n        default: null,\n        parseHTML: element => element.getAttribute('data-time') || new Date().getTime(),\n        renderHTML: attributes => ({\n          'data-time': attributes.time,\n          'locale-string': new Date(attributes.time).toLocaleString('en-US', {\n            month: 'short',\n            day: 'numeric',\n            hour: 'numeric',\n            minute: 'numeric',\n          }),\n        })\n      },\n      uid: {\n        default: null,\n        renderHTML: attributes => ({\n          id: attributes.uid\n        })\n      },\n      color: {\n        default: NOT_URGENT,\n        renderHTML: attributes => ({\n          style: `background: ${attributes.color}`\n        })\n      }\n    }\n  },\n\n  onCreate() {\n    const transaction = this.editor.state.tr;\n    this.editor.state.doc.descendants((node, pos) => {\n      if (node.type.name === 'text') {\n        const timeMark = node.marks.find((mark) => mark.type.name === this.name);\n        if (timeMark !== undefined) {\n          const start = pos;\n          const end = pos + node.nodeSize;\n          transaction.removeMark(start, end, timeMark);\n          const newMark = this.type.create({\n            color: calculateUrgency(new Date(timeMark.attrs.time)),\n            time: timeMark.attrs.time,\n            uid: nanoid(),\n          })\n          transaction.addMark(start, end, newMark);\n        }\n      }\n    });\n\n    transaction.setMeta('addToHistory', false);\n    transaction.setMeta('preventUpdate', true);\n    this.editor.view.dispatch(transaction);\n  },\n\n  onUpdate() {\n    const transaction = this.editor.state.tr;\n    this.editor.state.doc.descendants((node, pos) => {\n      if (node.type.name === 'text') {\n        const timeMark = node.marks.find((mark) => mark.type.name === this.name);\n        if (timeMark !== undefined) {\n          const start = pos;\n          const end = pos + node.nodeSize;\n          const newTime = parseTime(node.text);\n          if (newTime) {\n            const newMark = this.type.create({\n              ...newTime,\n              uid: timeMark.attrs.uid,\n              color: calculateUrgency(new Date(newTime.time))\n            })\n            transaction.removeMark(start, end, timeMark);\n            transaction.addMark(start, end, newMark);\n          }\n        }\n      }\n    });\n\n    transaction.setMeta('addToHistory', false);\n    transaction.setMeta('preventUpdate', true);\n    this.editor.view.dispatch(transaction);\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: 'span[data-time]',\n      },\n    ]\n  },\n\n  addInputRules() {\n    return [\n      markInputRule({\n        find: /(?:\\s\\()(due\\s.+)(?:\\))/,\n        type: this.type,\n        getAttributes\n      }),\n    ]\n  },\n\n  addPasteRules() {\n    return [\n      markPasteRule({\n        find: /(?:\\s\\()(due\\s.+)(?:\\))/g,\n        type: this.type,\n        getAttributes\n      }),\n    ]\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return [\n      'span',\n      HTMLAttributes,\n      0,\n    ]\n  },\n})\n","import React, { DragEvent, useEffect } from 'react';\nimport { useEditor, EditorContent } from '@tiptap/react'\nimport { Editor as TiptapEditor } from '@tiptap/core'\nimport StarterKit from '@tiptap/starter-kit'\nimport { load, save } from './storage';\nimport './Editor.css';\nimport Focus from '@tiptap/extension-focus';\nimport Link from '@tiptap/extension-link';\nimport Placeholder from '@tiptap/extension-placeholder';\nimport Typography from '@tiptap/extension-typography';\nimport Image from '@tiptap/extension-image';\nimport { TimedTask } from './tasks/TimedTask';\n\nconst PLACEHOLDER_TEXT = `Welcome to your TabSpace!\n\nTreat this as your own little scratchspace in the comfort of your new tab page.\n\n- Markdown-like syntax is supported and notes are saved in real-time.\n- To create a new to-do task, write (due <deadline>) in a block.\n\nThis is your new digital home, set it up however you'd like!\n`\n\nexport interface Tasks {\n  due: number, // JS date in milliseconds past epoch\n  uid: string,\n}\n\ninterface IEditor {\n  setTasks: (cb: ((tasks: Tasks[]) => Tasks[])) => void,\n}\n\nconst Editor = ({ setTasks }: IEditor) => {\n  const refreshTasks = (editor: TiptapEditor) => {\n    const newTasks: Tasks[] = []\n    editor.state.doc.descendants((node) => {\n      if (node.type.name === 'text') {\n        const timeMark = node.marks.find((mark) => mark.type.name === 'timedTask');\n        if (timeMark !== undefined) {\n          newTasks.push({ due: timeMark.attrs.time, uid: timeMark.attrs.uid })\n        }\n      }\n    });\n\n    setTasks((oldTasks: Tasks[]) => {\n      if (JSON.stringify(oldTasks) !== JSON.stringify(newTasks)) {\n        return newTasks;\n      } else {\n        return oldTasks;\n      }\n    })\n  }\n\n  const editor = useEditor({\n    extensions: [\n      StarterKit.configure({\n        heading: {\n          levels: [1, 2, 3],\n        },\n        codeBlock: {\n          HTMLAttributes: {\n            class: 'highlight'\n          }\n        }\n      }),\n      Focus.configure({\n        mode: 'deepest',\n      }),\n      Link.configure({\n        protocols: ['mailto'],\n      }),\n      Placeholder.configure({\n        placeholder: PLACEHOLDER_TEXT,\n      }),\n      Typography,\n      Image,\n      TimedTask,\n    ],\n    content: load(),\n    onCreate: ({ editor }) => refreshTasks(editor),\n    onUpdate: ({ editor }) => {\n      refreshTasks(editor);\n      save(editor.getJSON())\n    }\n  });\n\n  // @ts-ignore\n  window['tabspace'] = {\n    dump: () => editor ? editor.getJSON() : null\n  };\n\n  useEffect(() => {\n    const updateClosure = (event: StorageEvent) => {\n      if (event.storageArea !== localStorage) return;\n      if (event.key === 'blocks' && event.newValue !== null) {\n        if (editor) {\n          editor.commands.setContent(JSON.parse(event.newValue));\n          refreshTasks(editor);\n        }\n      }\n    };\n    window.addEventListener('storage', updateClosure);\n    return () => window.removeEventListener('storage', updateClosure);\n  }, [editor]);\n\n  const handleDrop = (evt: DragEvent) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n    const fileList = evt.dataTransfer.files;\n    if (fileList.length >= 1) {\n      const file = fileList[0];\n      const reader = new FileReader();\n      reader.addEventListener('load', (evt) => {\n        if (evt.target && editor) {\n          const uploaded_image = \"\" + evt.target.result;\n          editor.chain().focus().setImage({ src: uploaded_image }).run()\n        }\n      });\n      reader.readAsDataURL(file);\n    }\n  }\n\n  if (!editor) {\n    return null\n  }\n\n  return (\n    <EditorContent onDrop={handleDrop} editor={editor} />\n  )\n}\n\nexport default Editor;\n","import React, { useEffect, useState } from 'react';\nimport './Greeting.css';\n\ninterface IGreeting {\n  numTasks: number,\n  numUrgentTasks: number,\n}\n\nfunction calculateGreeting() {\n  const hour = new Date().getHours();\n  if (hour < 12) {\n    return \"Good morning\"\n  } else if (hour < 18) {\n    return \"Good afternoon\"\n  } else {\n    return \"Good evening\"\n  }\n}\n\nfunction calculateTaskString(numTasks: number, numUrgentTasks: number) {\n  if (numTasks === 0) {\n    return \"You have nothing due.\"\n  }\n  const tasks = numTasks === 1 ? 'task' : 'tasks'\n  return `You have ${numTasks} ${tasks} due, ${numUrgentTasks} of which need to be done soon.`\n}\n\nfunction Greeting(props: IGreeting) {\n  const greeting = calculateGreeting();\n  const calcTime = () => new Date().toLocaleTimeString(undefined, { hour: \"numeric\", minute: \"numeric\"});\n  const [time, setTime] = useState(calcTime());\n\n  useEffect(() => {\n    const timer = setInterval(() => setTime(calcTime()), 1000)\n    return () => clearInterval(timer)\n  }, [])\n\n  return (<div className=\"overlay\">\n    <h1>{time}</h1>\n    <p>{greeting}. {calculateTaskString(props.numTasks, props.numUrgentTasks)}</p>\n  </div>)\n}\n\nexport default Greeting\n","import React, { useCallback, useEffect, useRef } from 'react'\nimport { forceCollide, forceManyBody } from 'd3-force'\nimport ForceGraph2D, { ForceGraphMethods } from 'react-force-graph-2d';\nimport { Tasks } from './Editor';\nimport { MS_IN_DAYS } from './tasks/TimedTask';\nimport { withSize } from 'react-sizeme';\nimport Greeting from './Greeting';\nimport './Visualization.css'\n\ninterface IVisualization {\n  tasks: Tasks[],\n  theme: string,\n  size: {\n    width: number,\n    height: number,\n  }\n}\n\nfunction daysDiff(date: number) {\n  return Math.max(0, date - (new Date().getTime())) / MS_IN_DAYS\n}\n\nfunction dateToSize(date: number) {\n  return 29 * Math.pow(1.5, -daysDiff(date)) + 1\n}\n\nfunction isDueSoon(task: Tasks) {\n  return daysDiff(task.due) < 3\n\n}\n\nfunction Visualization(props: IVisualization) {\n  const fgRef = useRef<ForceGraphMethods>();\n  const nodes = props.tasks.map(task => ({\n    id: task.uid,\n    val: dateToSize(task.due)\n  }))\n\n  useEffect(() => {\n    const fg = fgRef.current;\n    if (fg) {\n      fg.d3Force('charge', forceManyBody().strength(15));\n      // @ts-ignore\n      fg.d3Force('collide', forceCollide().radius(node => 4 * Math.sqrt(node.val)));\n      fg.d3ReheatSimulation();\n    }\n  }, [fgRef.current]);\n\n  // @ts-ignore\n  const paint = useCallback((node, ctx) => {\n    const isDark = props.theme === 'dark';\n    ctx.fillStyle = isDark ? \"#444444\" : \"#cacaca\";\n    ctx.beginPath();\n    ctx.arc(node.x, node.y, 4 * Math.sqrt(node.val), 0, 2 * Math.PI, false);\n    ctx.fill();\n  }, [props.theme])\n\n  return <div className=\"visualization\">\n    <Greeting numTasks={props.tasks.length} numUrgentTasks={props.tasks.filter(isDueSoon).length} />\n    <ForceGraph2D\n      ref={fgRef}\n      height={450}\n      width={props.size.width}\n      nodeLabel=\"\"\n      onNodeClick={(node) => {\n        const nodeEl = document.getElementById((node.id || \"\").toString());\n        if (nodeEl) {\n          nodeEl.classList.add(\"highlight\");\n          nodeEl.scrollIntoView();\n          setTimeout(() => nodeEl.classList.remove(\"highlight\"), 800);\n        }\n      }}\n      enablePanInteraction={false}\n      enableZoomInteraction={false}\n      nodeCanvasObject={paint}\n      graphData={{ nodes, links: [] }}\n    />\n  </div>\n}\n\nexport default withSize()(Visualization);\n","import React, { useState } from 'react';\nimport './App.css';\nimport Darkmode, { loadDefault } from './Darkmode';\nimport Editor, { Tasks } from './Editor';\nimport Visualization from './Visualization';\n\nfunction App() {\n  const [tasks, setTasks] = useState<Tasks[]>([]);\n  const [theme, setTheme] = useState(loadDefault());\n  return (\n    <div className=\"App\">\n      <Darkmode theme={theme} setTheme={setTheme} />\n      <Visualization tasks={tasks} theme={theme} />\n      <Editor setTasks={setTasks} />\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\n\nconst root = ReactDOM.createRoot(\n  document.getElementById('root') as HTMLElement\n);\n\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n\n"],"sourceRoot":""}